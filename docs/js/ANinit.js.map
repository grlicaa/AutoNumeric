{"version":3,"names":[],"mappings":"","sources":["ANinit.js"],"sourcesContent":["/**\r\n * ANinit.js v1.0.1 | THE RIGHT THING SOLUTIONS d.o.o. | Andrej Grlica | andrej.grlica@right-thing.solutions.si \r\n * User with Oracle APEX plug-in to render data\r\n * Â© 2020 Andrej Grlica\r\n * Dependencies : autonumeric.js@4.6.0\r\n * Released under the MIT License.\r\n */\r\nfunction ANgetNumStr(pVal, pOpt, isRplace) {\r\n\tvar x = document.createElement(\"input\");\r\n\t    x.setAttribute(\"type\", \"hidden\");\r\n\t\r\n\tvar anElement  = new AutoNumeric(x, (isRplace?((\"\"+pVal).replace(\",\",\".\")):pVal), pOpt );\r\n\tvar lreturn = anElement.getFormatted();\t\r\n\tvar lclasses = $(x).attr(\"class\");\r\n\r\n\r\n\treturn {val:lreturn, class:lclasses};\r\n}\r\n\r\nfunction ANIGevents(itemId, opt, isRplace) {\r\n    \r\n\tvar ANelem;\r\n\r\n\t$(\"#\"+itemId).focusin(function(hnd) {\r\n\t\tvar lVal = $(this).val();\r\n\t\tapex.debug.message(5, \"[Plug-in AN] focusin %s value :%s\", itemId, lVal);\r\n\t\tif (lVal)\r\n\t\t\tANelem = new AutoNumeric(this, (isRplace?((\"\"+lVal).replace(\",\",\".\")):lVal) , opt );\t\r\n\t\telse\r\n\t\t\tANelem = new AutoNumeric(this, opt );\t\r\n\r\n\t\tif (lVal == \"\" && ANelem.settings.styleRules) {\r\n\t\t\tif (ANelem.settings.styleRules.ranges) {\r\n\t\t\t\tObject.getOwnPropertyNames(ANelem.settings.styleRules.ranges).forEach(function(val, idx, array) {\r\n\t\t\t\t\tif (val == \"class\")\r\n\t\t\t\t\t\t$(\"#\"+itemId).removeClass(ANelem.settings.styleRules.ranges[val]);\r\n\t\t\t\t  });\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tObject.getOwnPropertyNames(ANelem.settings.styleRules).forEach(function(val, idx, array) {\r\n\t\t\t\t\t$(\"#\"+itemId).removeClass(ANelem.settings.styleRules[val]);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tANelem.reformat();\t\t\r\n\t} );\t \r\n\r\n\t$(\"#\"+itemId).focusout(function() {\r\n\t\tvar result  = \"\";\r\n\t\tif (ANelem.get()!=\"\") {\r\n\t\t\tresult =(isRplace?((\"\"+ ANelem.getNumber()).replace(\".\",\",\")): ANelem.getNumber()) ;\r\n\t\t}\r\n\t\tANelem.remove();\r\n\t\tapex.debug.message(5, \"[Plug-in AN] focusout %s value :%s\", itemId, result);\r\n\t\t$(this).val(result);\r\n\t});\r\n  \r\n}\r\n\r\nfunction ANIGsetAliment(itemId) {\r\n\tvar $elm = $(\"div.ig-div-autonumeric:has(input[id^='\"+itemId+\"_']):first\").parent();\r\n\tif ($elm.hasClass(\"u-tE\")) {\r\n\t\t$(\"#\"+itemId).css(\"text-align\",\"right\");\r\n\t}\r\n\telse if ($elm.hasClass(\"u-tC\")) {\r\n\t\t$(\"#\"+itemId).css(\"text-align\",\"center\");\r\n\t}\r\n}\r\n\r\nfunction ANIGinit(itemId, opt, isRplace) {\r\n  apex.debug.message(4,\"[Plug-in AN] ANIGinit(id:%s, replace_numbers:%s)\", itemId,isRplace);\r\n  var index = 0;\r\n  const item$ = $('#'+itemId);\r\n  const sr$ = item$.addClass('u-vh is-focusable')\r\n\t.parent();\r\n\r\n  \r\n\r\n  function render(value) {\r\n\tvar showVal = ANgetNumStr(value, opt, isRplace);\t\r\n    const out = apex.util.htmlBuilder();\r\n    out.markup('<div')\r\n\t  .attr('class', 'ig-div-autonumeric '+(showVal.class?\"ig-autonumeric-custom \"+showVal.class:\"\"))\r\n\t  .attr('class', )\r\n\t  .markup('><input')\r\n      .attr('type', 'hidden')\r\n\t  .attr('class', 'ig-auto-numeric')\r\n      .attr('id', itemId+'_'+index+'_0')\r\n\t  .attr('name', itemId+'_'+index)\r\n\t  .attr('value', (isRplace?((\"\"+value).replace(\".\",\",\")):value))\r\n      .attr('tabindex', -1)\r\n      .markup(' /><label')\r\n\t  .attr('for', itemId+'_'+index+'_0')\r\n      .markup('>')\r\n      .content(showVal.val)\r\n      .markup('</label>')\r\n\t  .markup('</div>');\r\n\r\n    index += 1;\r\n\t\r\n    return out.toString();\r\n  }\r\n\r\n\t$( document ).ready(function() {\r\n\t\t//add events focus in/out\r\n\t\tANIGevents(itemId, opt, isRplace);\r\n  \r\n\t\t//add aliment\r\n\t\tANIGsetAliment(itemId);\r\n   });\r\n  \r\n  apex.item.create(itemId, {\r\n\tsetValue:function(pValue, pDisplayValue) {\r\n\t  item$.val(pValue);\r\n\t  //item$.closest('label').text(pDisplayValue);\t  \r\n\t  apex.debug.message(5, \"[Plug-in AN] apex item: %s set value : %s\",itemId,pValue);\r\n\t},\r\n\tdisable:function() {\r\n\t  item$.closest('.ig-div-autonumeric').removeClass('ig-div-autonumeric-enabled');\r\n\t  item$.closest('.ig-div-autonumeric').addClass('ig-div-autonumeric-disabled');\r\n\t  item$.attr('readonly','readonly');\r\n\t  item$.addClass('apex_disabled');\r\n\t},\r\n    isDisabled: function() {\r\n        return item$.closest('.ig-div-autonumeric').hasClass('ig-div-autonumeric-disabled');\r\n    },\t\r\n    enable:function() {\r\n\t\titem$.closest('.ig-div-autonumeric').removeClass('ig-div-autonumeric-disabled');\r\n\t\titem$.closest('.ig-div-autonumeric').addClass('ig-div-autonumeric-enabled');\r\n\t\t//item$.parents(\":eq(1)\").removeClass(\"is-readonly\").attr(\"tabindex\", \"\");\r\n\t\titem$.removeAttr('readonly');\r\n\t\titem$.removeClass('apex_disabled');\r\n    },\r\n    displayValueFor:function(value) {\r\n      return render(value);\r\n\t}\r\n  });\r\n  \r\n}\r\n\r\nfunction ANForminit(itemId, opt, isRplace) {\r\n\r\n\tapex.debug.message(4,\"[Plug-in AN] ANForminit(id:%s, replace_numbers:%s)\", itemId,isRplace);\r\n\r\n\tnew AutoNumeric(\"#\"+itemId, opt);\r\n\t\r\n\tapex.jQuery( apex.gPageContext$ ).on( \"apexbeforepagesubmit\", function() {\r\n\t\t\r\n\t\tif (AutoNumeric.isManagedByAutoNumeric(\"#\"+itemId)) {\r\n\t\t\tvar el = AutoNumeric.getAutoNumericElement(\"#\"+itemId);\r\n\t\t\tif (el.get()!=\"\") {\r\n\t\t\t\t var result = el.getNumber()\r\n\t\t\t\t el.remove();\r\n\t\t\t\t var lVal = (isRplace?((\"\"+result).replace(\".\",\",\")):result);\r\n\t\t\t\t apex.debug.message(5,\"[Plug-in AN] apexbeforepagesubmit id:%s, value:%s\", itemId,lVal);\r\n\t\t\t\t apex.item(itemId ).setValue(lVal);\r\n\t\t\t }\r\n\t\t}\r\n\t} );\r\n\t\r\n\r\n\t$(\"#\"+itemId).focusin(function(hnd) {\r\n\t\t$(this).parents(\":eq(2)\").addClass(\"is-active\");\r\n\t} );\t \r\n\r\n\t$(\"#\"+itemId).focusout(function() {\r\n\t\t$(this).parents(\":eq(2)\").removeClass(\"is-active\");\r\n\t});\t\r\n}"],"file":"ANinit.js"}